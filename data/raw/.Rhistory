order <- read.csv("C:\Users\sjara\Downloads\wc_order.csv")
order <- read.csv("C:/Users/sjara/Downloads/wc_order.csv")
glimpse(order)
head(order)
install.packages(tidyverse)
install.packages("tidyverse")
glimpse(order)
library(dplyr)
glimpse(order)
source('C:/Users/sjara/git/made-in-america-yarns/scratch.R', echo=TRUE)
write.csv(order, "order_keep.csv", row.names = FALSE)
glimpse(order_keep)
source('C:/Users/sjara/git/made-in-america-yarns/scratch.R', echo=TRUE)
source('C:/Users/sjara/git/made-in-america-yarns/scratch.R', echo=TRUE)
glimpse(order)
glimpse(product)
order %>% mutate(order_id = as.character(order_id)) %>% glimpse()
check_empty <- function(df){
#checks every column in df for NAs and ""
df <- data.frame("any_nas" = apply(df, 2, function(df) any(is.na(df))),
"any_empty_character_vectors" = apply(df, 2, function(df) any(df == "")))
return(df)
}
check_empty_glimpse <- function(df){
#print name of df, preview data, check NAs and ""
print(deparse(substitute(df)))
glimpse(df)
check_empty(df)
}
check_empty(order)
check_empty_glimpse(order)
substitute(order)
type_of(substitute(order))
typeof(substitute(order))
typeof(deparse(substitute(order)))
head(as.Date(order$order_date))
head(hms(order$order_date))
head(ymd_hms(order$order_date))
library(lubridate)
library(tidyr)
head(ymd_hms(order$order_date))
head(hms(order$order_date))
head(ymd_hms(order$order_date))
order %>%
mutate(order_id = as.character(order_id),
order_date = ymd_hms(order$order_date)) %>%
glimpse()
order %>%
mutate(order_id = as.character(order_id),
order_date = ymd_hms(order$order_date),
order_time = hour(order_date)) %>%
glimpse()
order %>%
mutate(order_id = as.character(order_id),
order_date = ymd_hms(order$order_date),
order_hour = hour(order_date),
order_date = as_date(ymd_hms(order$order_date))) %>%
glimpse()
check_empty(order)
source('C:/Users/sjara/git/made-in-america-yarns/scratch.R', echo=TRUE)
order %>%
mutate(order_id = as.character(order_id),
order_date = ymd_hms(order$order_date),
order_hour = hour(order_date),
order_date = as_date(ymd_hms(order$order_date)),
customer_id_addition = id()) %>%
glimpse()
order %>%
mutate(order_id = as.character(order_id),
order_date = ymd_hms(order$order_date),
order_hour = hour(order_date),
order_date = as_date(ymd_hms(order$order_date)),
customer_id_addition = 1:nrow(order)) %>%
glimpse()
order %>%
mutate(order_id = as.character(order_id),
order_date = ymd_hms(order$order_date),
order_hour = hour(order_date),
order_date = as_date(ymd_hms(order$order_date)),
customer_id_addition = 1:nrow(order),
customer_id = unite(customer_id, customer_id_addition, sep="_")) %>%
glimpse()
order %>%
mutate(order_id = as.character(order_id),
order_date = ymd_hms(order$order_date),
order_hour = hour(order_date),
order_date = as_date(ymd_hms(order$order_date)),
customer_id_addition = 1:nrow(order),
customer_id = unite(as.character(customer_id), as.character(customer_id_addition), sep="_")) %>%
glimpse()
order %>%
mutate(order_id = as.character(order_id),
order_date = ymd_hms(order$order_date),
order_hour = hour(order_date),
order_date = as_date(ymd_hms(order$order_date)),
customer_id_addition = 1:nrow(order),
customer_id = unite(c(customer_id, customer_id_addition), sep="_")) %>%
glimpse()
order %>%
mutate(order_id = as.character(order_id),
order_date = ymd_hms(order$order_date),
order_hour = hour(order_date),
order_date = as_date(ymd_hms(order$order_date)),
customer_id_addition = 1:nrow(order),
customer_id = unite("customer_id", c(customer_id, customer_id_addition), sep="_")) %>%
glimpse()
order %>%
mutate(order_id = as.character(order_id),
order_date = ymd_hms(order$order_date),
order_hour = hour(order_date),
order_date = as_date(ymd_hms(order$order_date)),
customer_id_addition = 1:nrow(order)) %>%
unite("customer_id", c(customer_id, customer_id_addition), sep="_") %>%
glimpse()
check_empty(order)
order %>%
mutate(order_id = as.character(order_id),
order_date = ymd_hms(order$order_date),
order_hour = hour(order_date),
order_date = as_date(ymd_hms(order$order_date)),
customer_id_addition = 1:nrow(order),
billing_company = na_if("")) %>%
unite("customer_id", c(customer_id, customer_id_addition), sep="_") %>%
glimpse()
order %>%
mutate(order_id = as.character(order_id),
order_date = ymd_hms(order$order_date),
order_hour = hour(order_date),
order_date = as_date(ymd_hms(order$order_date)),
customer_id_addition = 1:nrow(order),
billing_company = na_if(billing_company,"")) %>%
unite("customer_id", c(customer_id, customer_id_addition), sep="_") %>%
glimpse()
check_empty(order)
order_clean <- order %>%
mutate(order_id = as.character(order_id),
order_date = ymd_hms(order$order_date),
order_hour = hour(order_date),
order_date = as_date(ymd_hms(order$order_date)),
customer_id_addition = 1:nrow(order),
billing_company = na_if(billing_company,"")) %>%
unite("customer_id", c(customer_id, customer_id_addition), sep="_") %>%
glimpse()
order_clean <- order %>%
mutate(order_id = as.character(order_id),
order_date = ymd_hms(order$order_date),
order_hour = hour(order_date),
order_date = as_date(ymd_hms(order$order_date)),
customer_id_addition = 1:nrow(order),
billing_company = na_if(billing_company,"")) %>%
unite("customer_id", c(customer_id, customer_id_addition), sep="_")
check_empty(order_clean)
check_empty <- function(df){
#checks every column in df for NAs and ""
df <- data.frame("any_nas" = apply(df, 2, function(df) any(is.na(df))),
"any_empty_character_vectors" = apply(df, 2, function(df) any(df == "", na.rm=TRUE)))
return(df)
}
check_empty(order_clean)
order_clean <- order %>%
mutate(order_id = as.character(order_id),
order_date = ymd_hms(order$order_date),
order_hour = hour(order_date),
order_date = as_date(ymd_hms(order$order_date)),
customer_id_addition = 1:nrow(order)) %>%
mutate_if(is.character, list(~na_if(.),"")) %>%
unite("customer_id", c(customer_id, customer_id_addition), sep="_") %>%
glimpse()
order_clean <- order %>%
mutate(order_id = as.character(order_id),
order_date = ymd_hms(order$order_date),
order_hour = hour(order_date),
order_date = as_date(ymd_hms(order$order_date)),
customer_id_addition = 1:nrow(order)) %>%
mutate_if(is.character, list(~na_if(.,""))) %>%
unite("customer_id", c(customer_id, customer_id_addition), sep="_") %>%
glimpse()
check_empty(order_clean)
glimpse(product)
check_empty(product)
product_clean <- product %>%
mutate(ID = as.character(ID)) %>%
mutate_if(is.character, list(~na_if(.,"")))
check_empty(product_clean)
glimpse(product_clean)
library(dplyr)
library(tidyr)
library(lubridate)
# IMPORT DATA
#--------------------------------------------------------------
# set working directory
setwd("C:/Users/sjara/git/made-in-america-yarns/data/raw")
# load keys to select necessary fields
order_fields <- read.csv("order_fields.csv") %>%
filter(keep==1)
product_fields <- read.csv("product_fields.csv") %>%
filter(keep==1)
# load raw data then select necessary fields
order <- read.csv("order.csv") %>%
select(order_fields$variable)
product <- read.csv("product.csv") %>%
select(product_fields$variable)
# CLEAN order df
#--------------------------------------------------------------
check_empty <- function(df){
#checks every column in df for NAs and ""
df <- data.frame("any_nas" = apply(df, 2, function(df) any(is.na(df))),
"any_empty_character_vectors" = apply(df, 2, function(df) any(df == "", na.rm=TRUE)))
return(df)
}
order <- order %>%
mutate(order_id = as.character(order_id),
order_date = ymd_hms(order$order_date),
order_hour = hour(order_date),
order_date = as_date(ymd_hms(order$order_date)),
customer_id_addition = 1:nrow(order)) %>%
mutate_if(is.character, list(~na_if(.,""), tolower(.))) %>%
unite("customer_id", c(customer_id, customer_id_addition), sep="_")
glimpse(order)
check_empty(order)
# CLEAN product df
#--------------------------------------------------------------
product <- product %>%
mutate(ID = as.character(ID)) %>%
mutate_if(is.character, list(~na_if(.,""), ~tolower(.)))
glimpse(product)
check_empty(product)
library(dplyr)
library(tidyr)
library(lubridate)
# IMPORT DATA
#--------------------------------------------------------------
# set working directory
setwd("C:/Users/sjara/git/made-in-america-yarns/data/raw")
# load keys to select necessary fields
order_fields <- read.csv("order_fields.csv") %>%
filter(keep==1)
product_fields <- read.csv("product_fields.csv") %>%
filter(keep==1)
# load raw data then select necessary fields
order <- read.csv("order.csv") %>%
select(order_fields$variable)
product <- read.csv("product.csv") %>%
select(product_fields$variable)
# CLEAN order df
#--------------------------------------------------------------
check_empty <- function(df){
#checks every column in df for NAs and ""
df <- data.frame("any_nas" = apply(df, 2, function(df) any(is.na(df))),
"any_empty_character_vectors" = apply(df, 2, function(df) any(df == "", na.rm=TRUE)))
return(df)
}
order <- order %>%
mutate(order_id = as.character(order_id),
order_date = ymd_hms(order$order_date),
order_hour = hour(order_date),
order_date = as_date(ymd_hms(order$order_date)),
customer_id_addition = 1:nrow(order)) %>%
mutate_if(is.character, list(~na_if(.,""), ~tolower(.))) %>%
unite("customer_id", c(customer_id, customer_id_addition), sep="_")
glimpse(order)
check_empty(order)
# CLEAN product df
#--------------------------------------------------------------
product <- product %>%
mutate(ID = as.character(ID)) %>%
mutate_if(is.character, list(~na_if(.,""), ~tolower(.)))
glimpse(product)
check_empty(product)
check_empty <- function(df){
#checks every column in df for NAs and ""
df <- data.frame("any_nas" = apply(df, 2, function(df) any(is.na(df))),
"any_empty_character_vectors" = apply(df, 2, function(df) any(df == "", na.rm=TRUE)))
return(df)
}
source('C:/Users/sjara/git/made-in-america-yarns/scratch.R', echo=TRUE)
