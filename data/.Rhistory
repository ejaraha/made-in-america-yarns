order <- read.csv("C:\Users\sjara\Downloads\wc_order.csv")
order <- read.csv("C:/Users/sjara/Downloads/wc_order.csv")
glimpse(order)
head(order)
install.packages(tidyverse)
install.packages("tidyverse")
glimpse(order)
library(dplyr)
glimpse(order)
shiny::runApp('C:/Users/sjara/git/made-in-america-yarns/miay-order-explorer')
runApp('C:/Users/sjara/git/made-in-america-yarns/miay-order-explorer')
shiny::runApp('C:/Users/sjara/git/made-in-america-yarns/miay-order-explorer')
runApp('C:/Users/sjara/git/made-in-america-yarns/miay-order-explorer')
runApp('C:/Users/sjara/git/made-in-america-yarns/miay-order-explorer')
runApp('C:/Users/sjara/git/made-in-america-yarns/miay-order-explorer')
runApp('C:/Users/sjara/git/made-in-america-yarns/miay-order-explorer')
runApp('C:/Users/sjara/git/made-in-america-yarns/miay-order-explorer')
library(shinythemes)
runApp('C:/Users/sjara/git/made-in-america-yarns/miay-order-explorer')
library(shiny)
library(shinythemes)
library(ggplot2)
runApp('C:/Users/sjara/git/made-in-america-yarns/miay-order-explorer')
glimpse(iris)
iris %>% ggplot(Sepal.Length) + geom_histogram()
iris %>% ggplot(aes(Sepal.Length)) + geom_histogram()
iris %>% ggplot(aes(Sepal.Length)) + geom_histogram() + theme(panel.background = =element_rect(fill=NA))
iris %>% ggplot(aes(Sepal.Length)) + geom_histogram() + theme(panel.background = element_rect(fill=NA))
runApp('C:/Users/sjara/git/made-in-america-yarns/miay-order-explorer')
# to do: test row counts and groupings against wpAdmin
setwd("C:/Users/sjara/git/made-in-america-yarns/data")
source("C:/Users/sjara/git/made-in-america-yarns/functions.R")
# get data
data_denorm <- read.csv("denormalized.csv", stringsAsFactors = FALSE) %>%
mutate("order_year" = year(order_date),
"order_month" = month(order_date),
"order_week" = week(order_date)) %>%
# replace NA values in usage & effect with "unassigned" so that filtering will work
mutate(across(c(meta.yarn_usage, effect), ~case_when(is.na(.x)==TRUE ~"unassigned",
TRUE ~ as.character(.x)))) %>%
# handle strange missing data
filter(is.na(quantity)==FALSE)
source("C:/Users/sjara/git/made-in-america-yarns/functions.R")
setwd("C:/Users/sjara/git/made-in-america-yarns/data/")
# update data
#-------------------------------------------------------------
data <- update()
# normalize data
#-------------------------------------------------------------
data_norm <- normalize(data)
product %>% glimpse()
data_norm$product %>% glimpse()
order_main_pivot <- data$order_main %>%#df_list$order_main %>%
# gather all "line_item_" columns
pivot_longer(cols = starts_with("line_item"),
names_to = "item",
values_to = "item_description",
values_drop_na = TRUE) %>%
# extract product info from item_description
mutate("product_id" = str_extract(item_description, "(?<=product_id:)[:digit:]*"),
"variation_id" = str_extract(item_description, "(?<=variation_id:)[:digit:]*"),
"quantity" = as.integer(str_extract(item_description, "(?<=quantity:)[:digit:]*(?=|total)")),
"name" = str_sub(str_trim(str_extract(item_description, "(?<=name:).*(?=product_id:)")),start=1, end=-2),
"color" = str_extract(item_description, "(?<=color:|colors:)[:alpha:]*[:space:]*[:alpha:]*[:space:]*[:alpha:]*")) %>%
separate(name, into = c("name", "detail"), sep = "-", extra="merge", fill="right") %>%
mutate_at(c("name", "detail"), str_trim) %>%
mutate(across(.cols = contains("_id"), as.character))
test <- order_main_pivot %>% filter(product_id == "0" & is.na(variation_id) == FALSE)
View(order_main_pivot)
View(order_main_pivot)
names(order_main_pivot)
order_main_pivot %>% distinct(product_id, variation_id, name, color, quantity)
test <- order_main_pivot %>% distinct(product_id, variation_id, name, color, quantity)
test %>% filter(product_id == "0" & is.na(variation_id)==FALSE) %>% glimpse()
test <- order_main_pivot %>% distinct(product_id, variation_id, name, color) %>% glimpse()
test <- order_main_pivot %>% distinct(product_id, variation_id, name, color)
test %>% filter(product_id == "0" & is.na(variation_id)==FALSE) %>% glimpse()
test_pid_0 <- test %>% filter(product_id == "0" & is.na(variation_id)==FALSE)
View(test_pid_0)
order_main_pivot %>% filter(product_id == "0", variation_id=="605") %>% glimpse()
order_main_pivot %>% filter(product_id == "0", variation_id=="19207") %>% glimpse()
order_main_pivot %>% filter(product_id == "0", variation_id=="16047") %>% glimpse()
order_main_pivot %>% filter(is.na(variation_id)==TRUE) %>% glimpse()
order_main_pivot %>% filter(is.na(variation_id)==TRUE & is.na(name)==FALSE) %>% glimpse()
order_main_pivot %>% filter(is.na(variation_id)==TRUE & is.na(name)==FALSE) %>% distinct(product_id, variation_id, name, color) %>%glimpse()
test_vidNA <-order_main_pivot %>% filter(is.na(variation_id)==TRUE & is.na(name)==FALSE) %>% distinct(product_id, variation_id, name, color)
View(test_vidNA)
88-38
data_denorm %>% filter(variation_id =="0000")
source("C:/Users/sjara/git/made-in-america-yarns/functions.R")
setwd("C:/Users/sjara/git/made-in-america-yarns/data/")
# update data
#-------------------------------------------------------------
data <- update()
# normalize data
#-------------------------------------------------------------
data_norm <- normalize(data)
order_main_pivot <- data$order_main %>%
# gather all "line_item_" columns
pivot_longer(cols = starts_with("line_item"),
names_to = "item",
values_to = "item_description",
values_drop_na = TRUE) %>%
# extract product info from item_description
mutate("product_id" = str_extract(item_description, "(?<=product_id:)[:digit:]*"),
"variation_id" = str_extract(item_description, "(?<=variation_id:)[:digit:]*"),
"quantity" = as.integer(str_extract(item_description, "(?<=quantity:)[:digit:]*(?=|total)")),
"name" = str_sub(str_trim(str_extract(item_description, "(?<=name:).*(?=product_id:)")),start=1, end=-2),
"color" = str_extract(item_description, "(?<=color:|colors:)[:alpha:]*[:space:]*[:alpha:]*[:space:]*[:alpha:]*")) %>%
separate(name, into = c("name", "detail"), sep = "-", extra="merge", fill="right") %>%
mutate_at(c("name", "detail"), str_trim) %>%
mutate(across(.cols = contains("_id"), as.character))
test_vidNA <-order_main_pivot %>% filter(is.na(variation_id)==TRUE & product_id=="0") %>% distinct(product_id, variation_id, name, color)
View(test_vidNA)
test_vidNA <-order_main_pivot %>% filter(is.na(variation_id)==TRUE & product_id!="0") %>% distinct(product_id, variation_id, name, color)
test_vidNA <-order_main_pivot %>% filter(is.na(variation_id)==TRUE & product_id!="0") %>% distinct(product_id, variation_id, name, color)  %>%   mutate(variation_id = case_when(is.na(variation_id)==TRUE & product_id !=0 ~ "0000",
TRUE ~ as.character(variation_id)))
View(test_vidNA)
n_0000 <- order_main_pivot %>% filter(variation_id == "0000") %>% nrow()
order_main_pivot <-order_main_pivot %>%    mutate(variation_id = case_when(is.na(variation_id)==TRUE & product_id !=0 ~ "0000",
TRUE ~ as.character(variation_id)))
n_0000 <- order_main_pivot %>% filter(variation_id == "0000") %>% nrow()
order_main_pivot <- order_main_pivot %>%mutate(product_id = case_when(product_id == "0" & is.na(variation_id) == FALSE ~ variation_id,
TRUE ~ as.character(product_id)),
# variation_id = "9999" indicates a missing variation_id as a result of issue [1]
# this is likely due to data loss
variation_id = case_when(product_id == variation_id ~"9999",
TRUE ~ as.character(variation_id))
)
n_0000 <- order_main_pivot %>% filter(variation_id == "0000") %>% nrow()
n_9999 <- order_main_pivot %>% filter(variation_id == "9999") %>% nrow()
order_main_pivot <- order_main_pivot %>% filter(product_id != "0" & is.na(variation_id)==TRUE)
n_9999 <- order_main_pivot %>% filter(variation_id == "9999") %>% nrow()
n_0000 <- order_main_pivot %>% filter(variation_id == "0000") %>% nrow()
source('C:/Users/sjara/git/made-in-america-yarns/update_db.r', echo=TRUE)
source('C:/Users/sjara/git/made-in-america-yarns/update_db.r', echo=TRUE)
order_main_pivot <- data$order_main %>%
# gather all "line_item_" columns
pivot_longer(cols = starts_with("line_item"),
names_to = "item",
values_to = "item_description",
values_drop_na = TRUE) %>%
# extract product info from item_description
mutate("product_id" = str_extract(item_description, "(?<=product_id:)[:digit:]*"),
"variation_id" = str_extract(item_description, "(?<=variation_id:)[:digit:]*"),
"quantity" = as.integer(str_extract(item_description, "(?<=quantity:)[:digit:]*(?=|total)")),
"name" = str_sub(str_trim(str_extract(item_description, "(?<=name:).*(?=product_id:)")),start=1, end=-2),
"color" = str_extract(item_description, "(?<=color:|colors:)[:alpha:]*[:space:]*[:alpha:]*[:space:]*[:alpha:]*")) %>%
separate(name, into = c("name", "detail"), sep = "-", extra="merge", fill="right") %>%
mutate_at(c("name", "detail"), str_trim) %>%
mutate(across(.cols = contains("_id"), as.character))
# handle three scenarios of product_id == "0" and/or variation_id == NA
order_main_pivot <- order_main_pivot %>%
# [1] product_id != "0" & variation_id is.na indicated a simple product
## for simple products, variation_id will be replaced with "0000" to explicitly indicate simple products
mutate(variation_id = case_when(is.na(variation_id)==TRUE & product_id !=0 ~ "0000",
TRUE ~ as.character(variation_id))) %>%
# [2] when there's a variation_id but no product_id:
## WooCommerce' mistake? the id listed as variation_id should actually be in the product_id column
## comparing against wcSmartManager plugin shows this
## for these instances, swap the contents of product_id and variation_id
mutate(product_id = case_when(product_id == "0" & is.na(variation_id) == FALSE ~ variation_id,
TRUE ~ as.character(product_id)),
# variation_id = "9999" indicates a missing variation_id as a result of issue [1]
# this is likely due to data loss
variation_id = case_when(product_id == variation_id ~"9999",
TRUE ~ as.character(variation_id))
)
order_main_pivot %>%filter(product_id == "0" & is.na(variation_id)==TRUE) %>% glimpse()
n_9999 <- order_main_pivot %>% filter(variation_id == "9999") %>% nrow()
n_0000 <- order_main_pivot %>% filter(variation_id == "0000") %>% nrow()
test <- order_main_pivot %>%filter(product_id == "0" & is.na(variation_id)==TRUE) %>% distinct(product_id, variation_id, name, color)
View(test)
n_9999 <- order_main_pivot %>% filter(variation_id == "9999") %>% distinct(order_id) %>% nrow()
n_0000 <- order_main_pivot %>% filter(variation_id == "0000") %>% distinct(order_id) %>% nrow()
View(test)
source('C:/Users/sjara/git/made-in-america-yarns/update_db.r', echo=TRUE)
source('C:/Users/sjara/git/made-in-america-yarns/update_db.r', echo=TRUE)
source('C:/Users/sjara/git/made-in-america-yarns/update_db.r', echo=TRUE)
source('C:/Users/sjara/git/made-in-america-yarns/update_db.r', echo=TRUE)
source('C:/Users/sjara/git/made-in-america-yarns/update_db.r', echo=TRUE)
source('C:/Users/sjara/git/made-in-america-yarns/update_db.r', echo=TRUE)
source('C:/Users/sjara/git/made-in-america-yarns/functions.R', echo=TRUE)
source('C:/Users/sjara/git/made-in-america-yarns/update_db.r', echo=TRUE)
source('C:/Users/sjara/git/made-in-america-yarns/update_db.r', echo=TRUE)
source('C:/Users/sjara/git/made-in-america-yarns/update_db.r', echo=TRUE)
source('C:/Users/sjara/git/made-in-america-yarns/functions.R', echo=TRUE)
source('C:/Users/sjara/git/made-in-america-yarns/update_db.r', echo=TRUE)
source('C:/Users/sjara/git/made-in-america-yarns/functions.R', echo=TRUE)
source('C:/Users/sjara/git/made-in-america-yarns/update_db.r', echo=TRUE)
# get data
data_denorm <- read.csv("denormalized.csv", stringsAsFactors = FALSE) %>%
mutate("order_year" = year(order_date),
"order_month" = month(order_date),
"order_week" = week(order_date)) %>%
# replace NA values in usage & effect with "unassigned" so that filtering will work
mutate(across(c(meta.yarn_usage, effect), ~case_when(is.na(.x)==TRUE ~"unassigned",
TRUE ~ as.character(.x)))) %>%
# handle strange missing data
filter(is.na(quantity)==FALSE)
data_denorm %>% filter(variation_id =="1111") %>% glimpse()
data_denorm %>% filter(is.na(variation_id) ==TRUE) %>% glimpse()
data_denorm %>% filter(variation_id == product_id) %>% glimpse()
shiny::runApp('C:/Users/sjara/git/made-in-america-yarns/miay-order-explorer')
test <- data_denorm %>% distinct(product_id, variation_id, name, color)
test %>% filter(variation_id=="1111")
runApp('C:/Users/sjara/git/made-in-america-yarns/miay-order-explorer')
test %>% filter(grep("3792")==TRUE)
test %>% filter(grepl("3792")==TRUE)
test %>% filter(grepl(test$name, "3792")==TRUE)
test %>% filter(grep(test$name, "3792")==TRUE)
test %>% filter(str_detect(test$name, "3792")==TRUE)
data_denorm %>% filter(product_id=="3680" & variation_id == "9999")%>% glimpse()
data_denorm %>% filter(order_id == "21416")%>% glimpse()
test %>% filter(is.na(color)==TRUE) %>% glimpse()
runApp('C:/Users/sjara/git/made-in-america-yarns/miay-order-explorer')
test %>% filter(is.na(color)==TRUE) %>% glimpse()
test <- data_denorm %>% distinct(product_id, variation_id, name, color)
test %>% filter(is.na(color)==TRUE) %>% glimpse()
# get data
data_denorm <- read.csv("denormalized.csv", stringsAsFactors = FALSE) %>%
mutate("order_year" = year(order_date),
"order_month" = month(order_date),
"order_week" = week(order_date),
color = case_when(variation_id == "1111" ~"simple",
TRUE ~ color)) %>%
# replace NA values in usage & effect with "unassigned" so that filtering will work
mutate(across(c(meta.yarn_usage, effect), ~case_when(is.na(.x)==TRUE ~"unassigned",
TRUE ~ as.character(.x)))) %>%
# handle strange missing data
filter(is.na(quantity)==FALSE)
test %>% filter(is.na(color)==TRUE) %>% glimpse()
source('C:/Users/sjara/git/made-in-america-yarns/update_db.r', echo=TRUE)
# get data
data_denorm <- read.csv("denormalized.csv", stringsAsFactors = FALSE) %>%
mutate("order_year" = year(order_date),
"order_month" = month(order_date),
"order_week" = week(order_date),
color = case_when(variation_id == "1111" ~"simple",
TRUE ~ color)) %>%
# replace NA values in usage & effect with "unassigned" so that filtering will work
mutate(across(c(meta.yarn_usage, effect), ~case_when(is.na(.x)==TRUE ~"unassigned",
TRUE ~ as.character(.x)))) %>%
# handle strange missing data
filter(is.na(quantity)==FALSE)
data_denorm %>% filter(is.na(color)==TRUE) %>% glimpse()
data_denorm %>% distinct(product_id, variation_id, name, color) %>% filter(is.na(color)==TRUE) %>% glimpse()
test <- data_denorm %>% distinct(product_id, variation_id, name, color) %>% filter(is.na(color)==TRUE)
View(test)
data_norm$order %>% filter(product_id %in% test$product_id & variation_id %in% test$variation_id) %>% glimpse()
data_norm$order %>% filter(product_id %in% as.list(test$product_id) & variation_id %in% as.list(test$variation_id)) %>% glimpse()
data_norm$order_product %>% filter(product_id %in% as.list(test$product_id) & variation_id %in% as.list(test$variation_id)) %>% glimpse()
test_order <- data_norm$order_product %>% filter(product_id %in% as.list(test$product_id) & variation_id %in% as.list(test$variation_id)) %>% glimpse()
View(test_order)
View(test_order)
order_main_pivot <- data$order_main %>%
# gather all "line_item_" columns
pivot_longer(cols = starts_with("line_item"),
names_to = "item",
values_to = "item_description",
values_drop_na = TRUE) %>%
# extract product info from item_description
mutate("product_id" = str_extract(item_description, "(?<=product_id:)[:digit:]*"),
"variation_id" = str_extract(item_description, "(?<=variation_id:)[:digit:]*"),
"quantity" = as.integer(str_extract(item_description, "(?<=quantity:)[:digit:]*(?=|total)")),
"name" = str_sub(str_trim(str_extract(item_description, "(?<=name:).*(?=product_id:)")),start=1, end=-2),
"color" = str_extract(item_description, "(?<=color:|colors:)[:alpha:]*[:space:]*[:alpha:]*[:space:]*[:alpha:]*")) %>%
separate(name, into = c("name", "detail"), sep = "-", extra="merge", fill="right") %>%
mutate_at(c("name", "detail"), str_trim) %>%
mutate(across(.cols = contains("_id"), as.character))
glimpse(order_main_pivot)
View(test)
order_main_pivot %>% filter(product_id %in test$product_id, variation_id %in% test$variation_id) %>% glimpse()
order_main_pivot %>% filter(product_id %in% test$product_id, variation_id %in% test$variation_id) %>% glimpse()
test_detail <- order_main_pivot %>% filter(product_id %in% test$product_id, variation_id %in% test$variation_id) %>% select(detail, color)%>% glimpse()
View(test_detail)
View(test_detail)
order_main_pivot <- df_list$order_main %>%
# gather all "line_item_" columns
pivot_longer(cols = starts_with("line_item"),
names_to = "item",
values_to = "item_description",
values_drop_na = TRUE) %>%
separate(name, into = c("name", "detail"), sep = "-", extra="merge", fill="right") %>%
mutate_at(c("name", "detail"), str_trim) %>%
# extract product info from item_description
mutate("product_id" = str_extract(item_description, "(?<=product_id:)[:digit:]*"),
"variation_id" = str_extract(item_description, "(?<=variation_id:)[:digit:]*"),
"quantity" = as.integer(str_extract(item_description, "(?<=quantity:)[:digit:]*(?=|total)")),
"name" = str_sub(str_trim(str_extract(item_description, "(?<=name:).*(?=product_id:)")),start=1, end=-2),
"color" = str_extract(item_description, "(?<=color:|colors:)[:alpha:]*[:space:]*[:alpha:]*[:space:]*[:alpha:]*"),
color = replace_na(detail)) %>%
mutate(across(.cols = contains("_id"), as.character))
order_main_pivot <- data$order_main %>%
# gather all "line_item_" columns
pivot_longer(cols = starts_with("line_item"),
names_to = "item",
values_to = "item_description",
values_drop_na = TRUE) %>%
separate(name, into = c("name", "detail"), sep = "-", extra="merge", fill="right") %>%
mutate_at(c("name", "detail"), str_trim) %>%
# extract product info from item_description
mutate("product_id" = str_extract(item_description, "(?<=product_id:)[:digit:]*"),
"variation_id" = str_extract(item_description, "(?<=variation_id:)[:digit:]*"),
"quantity" = as.integer(str_extract(item_description, "(?<=quantity:)[:digit:]*(?=|total)")),
"name" = str_sub(str_trim(str_extract(item_description, "(?<=name:).*(?=product_id:)")),start=1, end=-2),
"color" = str_extract(item_description, "(?<=color:|colors:)[:alpha:]*[:space:]*[:alpha:]*[:space:]*[:alpha:]*"),
color = replace_na(detail)) %>%
mutate(across(.cols = contains("_id"), as.character))
order_main_pivot <- data$order_main %>%
# gather all "line_item_" columns
pivot_longer(cols = starts_with("line_item"),
names_to = "item",
values_to = "item_description",
values_drop_na = TRUE) %>%
# extract product info from item_description
mutate("product_id" = str_extract(item_description, "(?<=product_id:)[:digit:]*"),
"variation_id" = str_extract(item_description, "(?<=variation_id:)[:digit:]*"),
"quantity" = as.integer(str_extract(item_description, "(?<=quantity:)[:digit:]*(?=|total)")),
"name" = str_sub(str_trim(str_extract(item_description, "(?<=name:).*(?=product_id:)")),start=1, end=-2),
"color" = str_extract(item_description, "(?<=color:|colors:)[:alpha:]*[:space:]*[:alpha:]*[:space:]*[:alpha:]*")) %>%
separate(name, into = c("name", "detail"), sep = "-", extra="merge", fill="right") %>%
mutate_at(c("name", "detail"), str_trim) %>%
mutate(color = replace_na(detail)) %>%
mutate(across(.cols = contains("_id"), as.character))
order_main_pivot %>% filter(is.na(color)==TRUE)
order_main_pivot %>% filter(is.na(color)==TRUE & is.na(name)==FALSE) %>% glimpse()
order_main_pivot <- data$order_main %>%
# gather all "line_item_" columns
pivot_longer(cols = starts_with("line_item"),
names_to = "item",
values_to = "item_description",
values_drop_na = TRUE) %>%
# extract product info from item_description
mutate("product_id" = str_extract(item_description, "(?<=product_id:)[:digit:]*"),
"variation_id" = str_extract(item_description, "(?<=variation_id:)[:digit:]*"),
"quantity" = as.integer(str_extract(item_description, "(?<=quantity:)[:digit:]*(?=|total)")),
"name" = str_sub(str_trim(str_extract(item_description, "(?<=name:).*(?=product_id:)")),start=1, end=-2),
"color" = str_extract(item_description, "(?<=color:|colors:)[:alpha:]*[:space:]*[:alpha:]*[:space:]*[:alpha:]*")) %>%
separate(name, into = c("name", "detail"), sep = "-", extra="merge", fill="right") %>%
mutate_at(c("name", "detail"), str_trim) %>%
#mutate(color = replace_na(detail)) %>%
mutate(across(.cols = contains("_id"), as.character))
order_main_pivot %>% filter(is.na(color)==TRUE & is.na(name)==FALSE) %>% glimpse()
order_main_pivot <- data$order_main %>%
# gather all "line_item_" columns
pivot_longer(cols = starts_with("line_item"),
names_to = "item",
values_to = "item_description",
values_drop_na = TRUE) %>%
# extract product info from item_description
mutate("product_id" = str_extract(item_description, "(?<=product_id:)[:digit:]*"),
"variation_id" = str_extract(item_description, "(?<=variation_id:)[:digit:]*"),
"quantity" = as.integer(str_extract(item_description, "(?<=quantity:)[:digit:]*(?=|total)")),
"name" = str_sub(str_trim(str_extract(item_description, "(?<=name:).*(?=product_id:)")),start=1, end=-2),
"color" = str_extract(item_description, "(?<=color:|colors:)[:alpha:]*[:space:]*[:alpha:]*[:space:]*[:alpha:]*")) %>%
separate(name, into = c("name", "detail"), sep = "-", extra="merge", fill="right") %>%
mutate_at(c("name", "detail"), str_trim) %>%
mutate(color = replace_na(order_main_pivot$detail)) %>%
mutate(across(.cols = contains("_id"), as.character))
order_main_pivot %>% filter(is.na(color)==TRUE & is.na(name)==FALSE) %>% glimpse()
order_main_pivot <- data$order_main %>%
# gather all "line_item_" columns
pivot_longer(cols = starts_with("line_item"),
names_to = "item",
values_to = "item_description",
values_drop_na = TRUE) %>%
# extract product info from item_description
mutate("product_id" = str_extract(item_description, "(?<=product_id:)[:digit:]*"),
"variation_id" = str_extract(item_description, "(?<=variation_id:)[:digit:]*"),
"quantity" = as.integer(str_extract(item_description, "(?<=quantity:)[:digit:]*(?=|total)")),
"name" = str_sub(str_trim(str_extract(item_description, "(?<=name:).*(?=product_id:)")),start=1, end=-2),
"color" = str_extract(item_description, "(?<=color:|colors:)[:alpha:]*[:space:]*[:alpha:]*[:space:]*[:alpha:]*")) %>%
separate(name, into = c("name", "detail"), sep = "-", extra="merge", fill="right") %>%
mutate_at(c("name", "detail"), str_trim) %>%
mutate(color = case_when(is.na(color) == TRUE ~detail,
TRUE ~color)) %>%
mutate(across(.cols = contains("_id"), as.character))
order_main_pivot %>% filter(is.na(color)==TRUE & is.na(name)==FALSE) %>% glimpse()
source('C:/Users/sjara/git/made-in-america-yarns/update_db.r', echo=TRUE)
runApp('C:/Users/sjara/git/made-in-america-yarns/miay-order-explorer')
runApp('C:/Users/sjara/git/made-in-america-yarns/miay-order-explorer')
