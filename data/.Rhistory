order <- read.csv("C:\Users\sjara\Downloads\wc_order.csv")
order <- read.csv("C:/Users/sjara/Downloads/wc_order.csv")
glimpse(order)
head(order)
install.packages(tidyverse)
install.packages("tidyverse")
glimpse(order)
library(dplyr)
glimpse(order)
library(ggplot2)
library(plotly)
library(dplyr)
library(tidyr)
library(lubridate)
library(stringr)
library(purrr)
setwd("C:/Users/sjara/git/made-in-america-yarns/data")
source("C:/Users/sjara/git/made-in-america-yarns/functions.R")
data <- read.csv("denormalized.csv", stringsAsFactors = FALSE)
data %>%
distinct(order_id, order_ym, product_id, quantity) %>%
group_by(order_ym, product_id) %>%
# number of orders for each product_id/user_type/order_ym combo
summarize(n_orders = n(),
sum_quantity = sum(quantity), .groups = "keep") %>%
ungroup() %>%
group_by(order_ym) %>%
# find top three products by user_type/order_ym
mutate("rank_orders" = dense_rank(desc(n_orders)),
"rank_quantity" = dense_rank(desc(sum_quantity))) %>%
# ############ how to do composite rank
# filter(rank_a %in% c(1,2,3)) %>%
# distinct(product_id, name, order_ym, user_type, rank, n_orders) %>%
# select(-product_id) %>%
arrange(rank_orders, rank_quantity) %>% glimpse()
data %>%
distinct(order_id, order_ym, product_id, quantity) %>%
group_by(order_ym, product_id) %>%
# number of orders for each product_id/user_type/order_ym combo
summarize(n_orders = n(),
sum_quantity = sum(quantity), .groups = "keep") %>%
ungroup() %>%
group_by(order_ym) %>%
# find top three products by user_type/order_ym
mutate("rank_orders" = dense_rank(desc(n_orders)),
"rank_quantity" = dense_rank(desc(sum_quantity))) %>%
# ############ how to do composite rank
# filter(rank_a %in% c(1,2,3)) %>%
# distinct(product_id, name, order_ym, user_type, rank, n_orders) %>%
# select(-product_id) %>%
arrange(order_ym, rank_orders, rank_quantity) %>% glimpse()
